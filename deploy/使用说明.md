# ğŸš€ MRæ¸¸æˆè¿è¥ç®¡ç†ç³»ç»Ÿ - ç¦»çº¿éƒ¨ç½²æŒ‡å—

> é€‚ç”¨äºç½‘ç»œå—é™æˆ–Dockeré•œåƒæ‹‰å–å¤±è´¥çš„æƒ…å†µ

---

## ğŸ“‹ éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

```
Windowsç”µè„‘                    æœåŠ¡å™¨
    â”‚                            â”‚
    â”œâ”€ 1. ä¸‹è½½Dockeré•œåƒ         â”‚
    â”‚                            â”‚
    â”œâ”€ 2. å¯¼å‡ºä¸ºtaræ–‡ä»¶          â”‚
    â”‚                            â”‚
    â”œâ”€ 3. ä¸Šä¼ åˆ°æœåŠ¡å™¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
    â”‚                            â”‚
    â”‚                            â”œâ”€ 4. å¯¼å…¥é•œåƒ
    â”‚                            â”‚
    â”‚                            â”œâ”€ 5. æ„å»ºåº”ç”¨
    â”‚                            â”‚
    â”‚                            â””â”€ 6. å¯åŠ¨æœåŠ¡
```

---

## ç¬¬ä¸€æ­¥ï¼šåœ¨Windowsä¸Šä¸‹è½½é•œåƒ

### æ–¹æ³•Aï¼šä½¿ç”¨PowerShellè„šæœ¬ï¼ˆæ¨èï¼‰

1. **ç¡®ä¿Docker Desktopæ­£åœ¨è¿è¡Œ**
   - æ‰“å¼€Docker Desktopåº”ç”¨
   - ç¡®ä¿çŠ¶æ€ä¸º"Running"

2. **ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell**
   - æŒ‰ `Win + X`
   - é€‰æ‹©"Windows PowerShell (ç®¡ç†å‘˜)"

3. **æ‰§è¡Œä¸‹è½½è„šæœ¬**
   ```powershell
   cd C:\liangz77\python_projects\github_projects\mr_gunking_user_system_spec\deploy

   # å…è®¸æ‰§è¡Œè„šæœ¬ï¼ˆé¦–æ¬¡éœ€è¦ï¼‰
   Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

   # æ‰§è¡Œä¸‹è½½è„šæœ¬
   .\windows-ä¸‹è½½é•œåƒ.ps1
   ```

4. **æŒ‰æç¤ºé€‰æ‹©è¦ä¸‹è½½çš„é•œåƒ**
   - é€‰é¡¹1ï¼šåªä¸‹è½½æ ¸å¿ƒé•œåƒï¼ˆçº¦230 MBï¼‰- **æ¨èé¦–æ¬¡éƒ¨ç½²**
   - é€‰é¡¹2ï¼šæ ¸å¿ƒ + å‰ç«¯é•œåƒï¼ˆçº¦450 MBï¼‰
   - é€‰é¡¹3ï¼šå…¨éƒ¨é•œåƒå«ç›‘æ§ï¼ˆçº¦1 GBï¼‰

5. **ç­‰å¾…ä¸‹è½½å®Œæˆ**
   - æ ¸å¿ƒé•œåƒå¤§çº¦éœ€è¦5-10åˆ†é’Ÿï¼ˆå–å†³äºç½‘é€Ÿï¼‰
   - ä¸‹è½½å®Œæˆåä¼šè‡ªåŠ¨å¯¼å‡ºä¸ºtaræ–‡ä»¶
   - æ–‡ä»¶ä¿å­˜åœ¨ï¼š`C:\docker-images\`

### æ–¹æ³•Bï¼šæ‰‹åŠ¨ä¸‹è½½ï¼ˆå¦‚æœè„šæœ¬å¤±è´¥ï¼‰

åœ¨PowerShellä¸­æ‰‹åŠ¨æ‰§è¡Œï¼š

```powershell
# åˆ›å»ºå¯¼å‡ºç›®å½•
mkdir C:\docker-images
cd C:\docker-images

# ä¸‹è½½æ ¸å¿ƒé•œåƒ
docker pull python:3.11-slim
docker pull postgres:14-alpine
docker pull redis:7-alpine

# å¯¼å‡ºä¸ºtaræ–‡ä»¶
docker save python:3.11-slim -o python-3.11-slim.tar
docker save postgres:14-alpine -o postgres-14-alpine.tar
docker save redis:7-alpine -o redis-7-alpine.tar

# æŸ¥çœ‹å¯¼å‡ºçš„æ–‡ä»¶
dir
```

---

## ç¬¬äºŒæ­¥ï¼šä¸Šä¼ é•œåƒåˆ°æœåŠ¡å™¨

### æ–¹æ³•Aï¼šä½¿ç”¨SCPå‘½ä»¤ï¼ˆæ¨èï¼‰

åœ¨PowerShellä¸­æ‰§è¡Œï¼š

```powershell
cd C:\docker-images

# ä¸Šä¼ æ‰€æœ‰taræ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼ˆæ›¿æ¢æˆä½ çš„æœåŠ¡å™¨IPï¼‰
scp *.tar root@ä½ çš„æœåŠ¡å™¨IP:/root/docker-images/
```

**æ³¨æ„ï¼š**
- é¦–æ¬¡è¿æ¥ä¼šæç¤ºæ˜¯å¦ä¿¡ä»»æœåŠ¡å™¨ï¼Œè¾“å…¥ `yes`
- éœ€è¦è¾“å…¥æœåŠ¡å™¨rootå¯†ç 
- ä¸Šä¼ æ—¶é—´å–å†³äºæ–‡ä»¶å¤§å°å’Œç½‘é€Ÿ

### æ–¹æ³•Bï¼šä½¿ç”¨WinSCPå›¾å½¢ç•Œé¢

1. **ä¸‹è½½WinSCP**
   - è®¿é—®ï¼šhttps://winscp.net/
   - ä¸‹è½½å¹¶å®‰è£…

2. **è¿æ¥åˆ°æœåŠ¡å™¨**
   - åè®®ï¼šSFTP
   - ä¸»æœºåï¼šä½ çš„æœåŠ¡å™¨IP
   - ç«¯å£ï¼š22
   - ç”¨æˆ·åï¼šroot
   - å¯†ç ï¼šä½ çš„æœåŠ¡å™¨å¯†ç 

3. **ä¸Šä¼ æ–‡ä»¶**
   - å·¦ä¾§æµè§ˆåˆ°ï¼š`C:\docker-images\`
   - å³ä¾§è¿›å…¥ï¼š`/root/docker-images/`
   - æ‹–æ‹½æ‰€æœ‰ `.tar` æ–‡ä»¶åˆ°å³ä¾§
   - ç­‰å¾…ä¸Šä¼ å®Œæˆ

### æ–¹æ³•Cï¼šä½¿ç”¨FileZilla

1. **ä¸‹è½½FileZilla**
   - è®¿é—®ï¼šhttps://filezilla-project.org/
   - ä¸‹è½½FileZilla Client

2. **é…ç½®è¿æ¥**
   - åè®®ï¼šSFTP
   - ä¸»æœºï¼šä½ çš„æœåŠ¡å™¨IP
   - ç”¨æˆ·åï¼šroot
   - å¯†ç ï¼šä½ çš„æœåŠ¡å™¨å¯†ç 
   - ç«¯å£ï¼š22

3. **ä¸Šä¼ æ–‡ä»¶**
   - æ“ä½œåŒWinSCP

---

## ç¬¬ä¸‰æ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²

### 1. SSHè¿æ¥åˆ°æœåŠ¡å™¨

åœ¨Windows PowerShellä¸­ï¼š

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

è¾“å…¥å¯†ç åç™»å½•ã€‚

### 2. ä¸Šä¼ éƒ¨ç½²è„šæœ¬ï¼ˆå¦‚æœè¿˜æ²¡ä¸Šä¼ ï¼‰

å¦‚æœä¹‹å‰æ²¡æœ‰ä¸Šä¼ è¿‡deployç›®å½•ï¼Œéœ€è¦å…ˆä¸Šä¼ ï¼š

åœ¨Windows PowerShellä¸­ï¼ˆæ–°å¼€ä¸€ä¸ªçª—å£ï¼‰ï¼š

```powershell
cd C:\liangz77\python_projects\github_projects\mr_gunking_user_system_spec
scp -r deploy backend frontend root@ä½ çš„æœåŠ¡å™¨IP:/root/
```

### 3. å¤åˆ¶æ–‡ä»¶åˆ°åº”ç”¨ç›®å½•

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# ç¡®ä¿åº”ç”¨ç›®å½•å­˜åœ¨
mkdir -p /opt/mr-game-ops

# å¤åˆ¶æ‰€æœ‰æ–‡ä»¶
cp -r /root/deploy/* /opt/mr-game-ops/
cp -r /root/backend /opt/mr-game-ops/
cp -r /root/frontend /opt/mr-game-ops/
```

### 4. æ‰§è¡Œéƒ¨ç½²è„šæœ¬

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /opt/mr-game-ops

# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x /root/deploy/server-å¯¼å…¥å¹¶éƒ¨ç½².sh

# æ‰§è¡Œéƒ¨ç½²
bash /root/deploy/server-å¯¼å…¥å¹¶éƒ¨ç½².sh
```

### 5. ç­‰å¾…éƒ¨ç½²å®Œæˆ

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… å¯¼å…¥æ‰€æœ‰Dockeré•œåƒ
- âœ… å‡†å¤‡é…ç½®æ–‡ä»¶
- âœ… æ„å»ºåç«¯åº”ç”¨
- âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡
- âœ… éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€

**æ•´ä¸ªè¿‡ç¨‹å¤§çº¦éœ€è¦10-15åˆ†é’Ÿã€‚**

---

## ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
cd /opt/mr-game-ops
docker compose -f docker-compose.prod.yml ps
```

æ‰€æœ‰æœåŠ¡çŠ¶æ€åº”è¯¥æ˜¯ `Up (healthy)`ã€‚

### 2. æµ‹è¯•APIè®¿é—®

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•
curl http://localhost:8000/health

# åº”è¯¥è¿”å›ï¼š{"status":"healthy"}
```

### 3. åœ¨æµè§ˆå™¨ä¸­è®¿é—®

åœ¨ä½ çš„ç”µè„‘æµè§ˆå™¨ä¸­è®¿é—®ï¼ˆæ›¿æ¢æˆä½ çš„æœåŠ¡å™¨IPï¼‰ï¼š

- APIå¥åº·æ£€æŸ¥ï¼š`http://æœåŠ¡å™¨IP:8000/health`
- APIæ–‡æ¡£ï¼š`http://æœåŠ¡å™¨IP:8000/docs`

å¦‚æœèƒ½è®¿é—®ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼ğŸ‰

---

## å¸¸è§é—®é¢˜

### Q1: PowerShellæç¤º"æ— æ³•æ‰§è¡Œè„šæœ¬"

**è§£å†³ï¼š**
```powershell
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
```

### Q2: Docker Desktopæœªè¿è¡Œ

**è§£å†³ï¼š**
- æ‰“å¼€Docker Desktopåº”ç”¨
- ç­‰å¾…çŠ¶æ€å˜ä¸º"Running"
- é‡æ–°æ‰§è¡Œè„šæœ¬

### Q3: ä¸Šä¼ é€Ÿåº¦å¾ˆæ…¢

**è§£å†³ï¼š**
- ä½¿ç”¨æœ‰çº¿ç½‘ç»œè€ŒéWiFi
- é€‰æ‹©ç½‘ç»œè¾ƒå¥½çš„æ—¶é—´æ®µä¸Šä¼ 
- å¦‚æœæœ‰å†…ç½‘ï¼Œç¡®ä¿ä½¿ç”¨å†…ç½‘IPä¸Šä¼ 

### Q4: æœåŠ¡å™¨ä¸Šå¯¼å…¥é•œåƒå¤±è´¥

**æ£€æŸ¥ï¼š**
```bash
# æ£€æŸ¥taræ–‡ä»¶æ˜¯å¦å®Œæ•´
cd /root/docker-images
ls -lh *.tar

# æ‰‹åŠ¨å°è¯•å¯¼å…¥å•ä¸ªé•œåƒ
docker load -i python-3.11-slim.tar
```

### Q5: Backendå®¹å™¨å¯åŠ¨å¤±è´¥

**æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
docker logs mr_game_ops_backend_prod --tail=100
```

**å¸¸è§åŸå› ï¼š**
- requirements.txtä¸­çš„æŸä¸ªåŒ…å®‰è£…å¤±è´¥
- ä»£ç æœ‰è¯­æ³•é”™è¯¯
- ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯

---

## ğŸ”§ åç»­æ“ä½œ

### åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿›å…¥backendå®¹å™¨
docker exec -it mr_game_ops_backend_prod bash

# è¿è¡Œåˆå§‹åŒ–è„šæœ¬
cd /app
python init_database.py

# é€€å‡ºå®¹å™¨
exit
```

### åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

```bash
# è¿›å…¥backendå®¹å™¨
docker exec -it mr_game_ops_backend_prod bash

# è¿è¡Œåˆ›å»ºç®¡ç†å‘˜è„šæœ¬
cd /app
python create_admin_simple_v2.py

# æŒ‰æç¤ºè¾“å…¥ç®¡ç†å‘˜ä¿¡æ¯
# é€€å‡ºå®¹å™¨
exit
```

### é…ç½®HTTPSï¼ˆå¯é€‰ï¼‰

å¦‚æœæœ‰åŸŸåï¼Œå¯ä»¥é…ç½®SSLè¯ä¹¦ï¼š

```bash
cd /opt/mr-game-ops
bash /root/deploy/03-setup-ssl.sh ä½ çš„åŸŸå.com
```

---

## ğŸ“ æ–‡ä»¶æ¸…å•

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶éƒ½å·²æ­£ç¡®æ”¾ç½®ï¼š

```
æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç»“æ„ï¼š

/root/
â”œâ”€â”€ docker-images/              # é•œåƒæ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ python-3.11-slim.tar
â”‚   â”œâ”€â”€ postgres-14-alpine.tar
â”‚   â””â”€â”€ redis-7-alpine.tar
â”‚
â””â”€â”€ deploy/
    â””â”€â”€ server-å¯¼å…¥å¹¶éƒ¨ç½².sh    # éƒ¨ç½²è„šæœ¬

/opt/mr-game-ops/               # åº”ç”¨ç›®å½•
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”œâ”€â”€ frontend/                   # å‰ç«¯ä»£ç ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ docker-compose.prod.yml     # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ .env.prod                   # ç¯å¢ƒé…ç½®
â””â”€â”€ .env                        # å®é™…ä½¿ç”¨çš„é…ç½®
```

---

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   docker compose -f /opt/mr-game-ops/docker-compose.prod.yml logs
   ```

2. **æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—**
   ```bash
   docker logs mr_game_ops_backend_prod --tail=100
   ```

3. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
   ```bash
   docker compose -f /opt/mr-game-ops/docker-compose.prod.yml ps
   ```

4. **é‡å¯æœåŠ¡**
   ```bash
   docker compose -f /opt/mr-game-ops/docker-compose.prod.yml restart
   ```

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€
